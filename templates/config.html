<!-- ==================== DEPENDÊNCIAS ==================== -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="/static/Css/config.css">

<!-- ==================== MODAL CONFIGURAÇÃO ==================== -->
<div class="modal-configuracao">

  <!-- HEADER -->
  <div class="header">
    <div>
      <h2>Configurações</h2>
      <small>Gerencie sua conta</small>
    </div>
    <div>
      <button onclick="FecharConfig()">✕</button>
    </div>
  </div>

  <!-- CONTAINER PRINCIPAL -->
  <div class="container">

    <!-- ==================== SIDEBAR ==================== -->
    <div class="sidebar">
      <button class="active" onclick="perfil()">
        <i class="fa-solid fa-user"></i> Perfil
      </button>
      <button onclick="modalSeguranca()">
        <i class="fa-solid fa-lock"></i> Segurança
      </button>
      <button onclick="ApagarConta()" >
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
        Deletar conta
      </button>
 
    </div>

    <!-- ==================== CONTENT ==================== -->
    <div class="content">

      <!-- SEÇÃO: PERFIL -->
      <div class="modal-perfil" id="edit-user-modal">
        <h3>Informações Pessoais</h3>
        <p>Atualize seus dados</p>

        {% for user in usuarios %}
        {% if user.id == id_logado %}

        <!-- Avatar -->
        <div class="user-avatar" >
          <img src="{{ user.image or '/static/imgs/foto-perfil.png' }}"
               alt="Foto de perfil"
               class="image-perfil">
        </div>

        <!-- GRID -->
        <div class="grid">

          <div>
            <label>Nome</label>
            <input type="text" id="name" value="{{ user.name }}">
          </div>

          <div>
            <label>Email</label>
            <input type="email" id="email" value="{{ user.email }}">
          </div>

          <div>
            <label>CPF</label>
            <input type="text" id="cpf" value="{{ user.cpf or '' }}" placeholder="000.000.000-00">
          </div>

          <div>
            <label>RG</label>
            <input type="text" id="rg" value="{{ user.rg or '' }}">
          </div>

          <div>
            <label>Data de Nascimento</label>
            <input type="date" id="data_nascimento" value="{{ user.data_nascimento }}">
          </div>

          <div>
            <label>Telefone</label>
            <input type="tel" id="telefone" value="{{ user.telefone or '' }}">
          </div>

          <div>
            <label>Departamento</label>
            <input type="text" id="departamento" value="{{ user.departamento or '' }}">
          </div>

          <div>
            <label>Função</label>
            <input type="text" id="funcao" value="{{ user.funcao or '' }}">
          </div>

          <div class="grid-full">
            <label>Endereço</label>
            <input type="text" id="endereco" value="{{ user.endereco or '' }}">
          </div>

        </div>

        <!-- AÇÕES -->
        <div class="actions">
          <button
            class="save"
                type="submit" 
               onclick="abrirEditarUsuario(
  '{{ user.id }}',
  '{{ user.image }}',
  '{{ user.name }}',
  '{{ user.email }}',
  '{{ user.cpf }}',
  '{{ user.rg }}',
  '{{ user.data_nascimento }}',
  '{{ user.telefone }}',
  '{{ user.endereco }}',
  '{{ user.departamento }}',
  '{{ user.funcao }}',
  '{{ user.role }}',
  '{{ user.status }}'
)">
                Editar Perfil
          </button>
        </div>

        {% endif %}
        {% endfor %}
      </div>

      <!-- SEÇÃO: SEGURANÇA -->
      <div class="modal-seguranca" style="display: none;">
     <form id="form-alterar-senha"data-user-id="{{ id_logado }}" onsubmit="alterarSenha(event)">
    
    <input type="password"
     id="senha-atual" 
     placeholder="Senha Atual" 
     required>

    <input 
      type="password" 
      id="senha-nova" 
      placeholder="Nova Senha" 
      minlength="6"
      required 
    />
   
    <input 
      type="password" 
      id="confirmar-senha" 
      placeholder="Confirmar Senha" 
      minlength="6"
      required 
    />
 
    <!--  Este botão APENAS altera a senha -->
    <button type="submit"  class="save">Alterar Senha</button>
  </form>
</div>


<div class="modal-excluir" style="display: none;">
        {% for user in usuarios %}
        {% if user.id == id_logado %}

        <h3>Ao excluir sua conta, todos os seus dados serão removidos permanentemente do sistema.
         Essa ação não poderá ser desfeita e você será deslogado automaticamente.</h3>

         <h3>Tem certeza de que deseja continuar?</h3>
 
  <button onclick="excluirUsuario('{{user.id }}')" class="btn-delete" >
  Deletar Conta</button>
{%endif%}
{%endfor%}
</div>
    </div>
    <!-- FIM CONTENT -->

  </div>
  <!-- FIM CONTAINER -->

</div>

<!-- ==================== MODAIS AUXILIARES ==================== -->
{% include 'modais/modal_usuario_config.html' %}

<!-- ==================== SCRIPTS ==================== -->
<script src="/static/Javascript/config.js"></script>
